name: Resolve Keystore Password

inputs:
  keystore_password:
    required: false

runs:
  using: composite
  steps:
    - shell: bash
      run: |
        if [ -n "${{ inputs.keystore_password }}" ]; then
          echo "::add-mask::${{ inputs.keystore_password }}"
          echo "KEYSTORE_PASSWORD=${{ inputs.keystore_password }}" >> $GITHUB_ENV
          echo "KEY_PASSWORD=${{ inputs.keystore_password }}" >> $GITHUB_ENV
          echo "ğŸ” Using provided password"
        else
          GEN_PASS=$(openssl rand -base64 32 | tr -d '=+/')
          echo "::add-mask::$GEN_PASS"
          echo "KEYSTORE_PASSWORD=$GEN_PASS" >> $GITHUB_ENV
          echo "KEY_PASSWORD=$GEN_PASS" >> $GITHUB_ENV
          echo "ğŸ” Generated strong password"
        fi
